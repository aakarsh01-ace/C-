// exactly same code as lowerbound